<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="LuftdatenInfo Timeslider">
<title>LuftdatenInfo Timeslider</title>
    <link rel="stylesheet" href="http://openlayers.org/en/v3.3.0/css/ol.css" type="text/css">
    <style>
      
	  html,body {
    height:100%;
    padding:0;
    margin:0;
}
	  
	  #map1 .ol-attribution {
	  bottom: 30px;
	  }
	  
	  #map2 .ol-attribution {
	  bottom: 30px;
	  }
	  
	  .map {
        height: 40%;
        width: 100%;
      }
	  
	  
	  .divT{
	  background-color: white;
	  height: 30px;
	  position: relative;
	  }
 .half-map {
  float: left;
      height: -moz-calc(50% - 100px);
    height: -webkit-calc(50% - 100px);
    height: calc(50% - 100px);
  
  
  width: 49%;
  background-color: #b5d0d0;
  border: solid 1px black;
}

input[type=number]{
    width: 30px;
} 
 .half-map2 {
  height: calc(50% - 100px);
  width: 50%;
  background-color: #b5d0d0;
}

.mouse-position{ position: absolute;
 left: 70px; 
 top: 150px;
 z-index: 1000; 
 font-weight:bold;
 background-color: rgba(0, 60, 136, 0.298039);
 padding: 5px;
 border-radius: 4px;}
 
 
 .helpDivS{
		 position: absolute;
		 top: 5px;
		 left: 450px;
		 z-index: 9999;
}

    #helpDiv { z-index:1;
  position: absolute;
  width: 650px;
  height: 500px;
  background-color: white;
  top: 80px;
  overflow: auto;
  left: 20px;
          border: 3px solid black;
	      padding: 5px;
  
 } 
 
 .downloadDivS{
		 position: absolute;
		 top: 1px;
		 left: 520px;
		 z-index: 9999;
}

    #downloadDiv { z-index:1;
  position: absolute;
  width: 650px;
  height: 500px;
  background-color: white;
  top: 80px;
  overflow: auto;
  left: 20px;
          border: 3px solid black;
	      padding: 5px;
  
 } 
 
 .left{
 left: 15px;
 position: relative;
 }
    </style>
    <script src="http://openlayers.org/en/v3.3.0/build/ol-debug.js" type="text/javascript"></script>
    <title>SensorMap</title>
  </head>
  <body>
  
    <h2>&nbsp;&nbsp;Test! Stündliche Daten von <a href="http://luftdaten.info/" target="_blank">LuftDaten.info </a></h2>
	<div class="helpDivS" id="helpDivS"><img id="help" onclick="helpMe()" src="images/help.png"></div>
	<div class="downloadDivS" id="downloadDivS"><img id="download" onclick="downloadMe()" src="images/download.png"></div>
	<p><div class="left" role="group" aria-label="Animation controls">
      <button id="play" type="button">Play</button>
      <button id="pause" type="button">Pause</button>
      <span id="info"></span>
    </div></p>
    <div id="map1" class="half-map">
	<div class="divT">&nbsp;&nbsp;PM 10: 
	<label for="pm10_1">Schwellenwert 1:</label>
<input id="pm10_1" type="number" name="pm10_1" value="15" maxlength="4" size="4">
<label for="pm10_2">Schwellenwert 2:</label>
<input id="pm10_2" type="number" name="pm10_2" value="25" maxlength="4" size="4">
<button type="button" name="reload1" id="reload1">Neu laden</button>
	</div></div>
    <div id="map2" class="half-map">
	<div class="divT">&nbsp;&nbsp;PM 2,5:
	<label for="pm25_1">Schwellenwert 1:</label>
<input id="pm25_1" type="number" name="pm25_1" value="5">
<label for="pm25_2">Schwellenwert 2:</label>
<input id="pm25_2" type="number" name="pm25_2" value="10">
<button type="button" name="reload2" id="reload2">Neu laden</button>
	</div></div>
    <div id="map3" class="half-map">
	<div class="divT">&nbsp;&nbsp;Temperatur:
	<label for="temp_1">Schwellenwert 1:</label>
<input id="temp_1" type="number" name="temp_1" value="6">
<label for="temp_2">Schwellenwert 2:</label>
<input id="temp_2" type="number" name="temp_2" value="14">
<button type="button" name="reload3" id="reload3">Neu laden</button>
</div></div>
    <div id="map4" class="half-map">
	<div class="divT">&nbsp;&nbsp;Relative Luftfeuchtigkeit:
	<label for="humi_1">Schwellenwert 1:</label>
<input id="humi_1" type="number" name="humi_1" value="75">
<label for="humi_2">Schwellenwert 2:</label>
<input id="humi_2" type="number" name="humi_2" value="85">
<button type="button" name="reload4" id="reload4">Neu laden</button>
</div></div>
	<div id="mouse-position" class="mouse-position"></div> 
	
		<div id="helpDiv" style="display:none;"> 
<h1>Hilfe</h1>
<p>todo</p>
</div>
	
			<div id="downloadDiv" style="display:none;"> 
<h1>Download</h1>
<p>todo</p>
</div>
    <script type="text/javascript">
	
	
	
	
	// zuerst das datum setzen auf volle stunde
	//todo
	   function hoursAgo() {
        
		// return new Date((Date.now() / 3600000) * 3600000 - 3600000 * 3);
		
		// wann exakt ist der letzte Zeitpunkt? 
		// Erst mal minus 2 Tage
		// todo zeitzone berücksichtigen 
		
		var dateLast = new Date(Date.now());
		
		// minus 2 tAGE WÄRE FÜR lanuv dATEN INTERESSANT
		//dateLast.setDate(dateLast.getDate() - 2);  
        dateLast.setMinutes(0);
		dateLast.setSeconds(0);
		console.log(dateLast);
	    return dateLast;
		
      }
	  
	  
	var startDate = hoursAgo();
	
	// in Minuten
	//var offsetGMT = startDate.getTimezoneOffset();
	
	var gmtDate = new Date(startDate.valueOf() + startDate.getTimezoneOffset() * 60000);
	
	//2018-04-18 10:00:00
	var hours = gmtDate.getHours();
	if (hours < 10){hours = "0"+hours;}
var month = gmtDate.getMonth() + 1;
if (month < 10){month = "0"+month;}
var _date = gmtDate.getDate();
if (_date < 10){_date = "0"+_date;}

var datum = gmtDate.getFullYear()+"-"+ month+"-"+_date;
	var timestamp = datum + ' '+ hours+':00:00';
	console.log(timestamp);
	var iniDate = true;
	var frameRate = 0.5; // frames per second
      var animationId = null;

	  
    //	pm10
    // ori
//	var sldBody1 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:PropertyIsLessThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:PropertyIsGreaterThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	
	// pm 10
	var sldBody1 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	// pm 2,5
	var sldBody2 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
    //temp
	var sldBody3 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	// humidity
	var sldBody4 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	
	var layer1 = new ol.layer.Image({
    title: 'tracks',
		source: new ol.source.ImageWMS({url: 'http://www.opendem.info:8080/geoserver/opendem/wms',
	  attributions: [new ol.Attribution({html: "<br/><a href=\"http://luftdaten.info\">LuftDaten.info</a>"})],
	  params: {'LAYERS': 'opendem:luftdateninfo',
		  'SLD_BODY' : sldBody1},
		  serverType: 'geoserver'})
    });	
	
	var layer2 = new ol.layer.Image({
    title: 'tracks',
		source: new ol.source.ImageWMS({url: 'http://www.opendem.info:8080/geoserver/opendem/wms',
	  attributions: [new ol.Attribution({html: "<br/><a href=\"http://luftdaten.info\">LuftDaten.info</a>"})],
	  params: {'LAYERS': 'opendem:luftdateninfo',
		  'SLD_BODY' : sldBody2},
		  serverType: 'geoserver'})
    });	
	
	var layer3 = new ol.layer.Image({
    title: 'tracks',
		source: new ol.source.ImageWMS({url: 'http://www.opendem.info:8080/geoserver/opendem/wms',
	  attributions: [new ol.Attribution({html: "<br/><a href=\"http://luftdaten.info\">LuftDaten.info</a>"})],
	  params: {'LAYERS': 'opendem:luftdateninfo',
		  'SLD_BODY' : sldBody3},
		  serverType: 'geoserver'})
    });	
	
	var layer4 = new ol.layer.Image({
    title: 'tracks',
		source: new ol.source.ImageWMS({url: 'http://www.opendem.info:8080/geoserver/opendem/wms',
	  attributions: [new ol.Attribution({html: "<br/><a href=\"http://luftdaten.info\">LuftDaten.info</a>"})],
	  params: {'LAYERS': 'opendem:luftdateninfo',
		  'SLD_BODY' : sldBody4},
		  serverType: 'geoserver'})
    });	

	   var layerOsm = new ol.layer.Tile({
        source: new ol.source.OSM()
      });
	  	  
	  
 var view = new ol.View({
        center: ol.proj.transform([6.9619, 50.9389], 'EPSG:4326', 'EPSG:3857'),
        zoom: 12
      });	  
	  
      var map1 = new ol.Map({
        target: 'map1',
        layers: [layerOsm,layer1],
		controls: ol.control.defaults({
    attributionOptions: /** @type {olx.control.AttributionOptions} */ ({
      collapsible: true
    })
  }).extend([
     new ol.control.ScaleLine(),
	 	  new ol.control.MousePosition({
        coordinateFormat: ol.coordinate.createStringXY(4),
        projection: 'EPSG:4326',
        // comment the following two lines to have the mouse position
        // be placed within the map.
        className: 'custom-mouse-position',
        target: document.getElementById('mouse-position')
        //definedHTML: '&nbsp;'
		//definedHTML: 'Coordinates'
      })
  ])
      });
      var map2 = new ol.Map({
        target: 'map2',
        layers: [layerOsm, layer2],
        view: view
      });
	  var map3 = new ol.Map({
        target: 'map3',
        layers: [layerOsm, layer3],
        view: view
      });
	  var map4 = new ol.Map({
        target: 'map4',
        layers: [layerOsm, layer4],
        view: view
      });
      // and bind the view properties so they effectively share a view
      map1.bindTo('view', map2);
	  map3.bindTo('view', map2);
	  map4.bindTo('view', map2); 
	  
	  	document.addEventListener("DOMContentLoaded", function (event) {
		
		
    var _selector1 = document.querySelector('button[name=reload1]');
    _selector1.addEventListener('click', function (event) {
    //var sldBody1 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdaten</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:PropertyIsLessThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:PropertyIsGreaterThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var sldBody1 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var layer1New = layer1.getSource();
	layer1New.updateParams({'SLD_BODY': sldBody1}); 
	map1.render();    
    });
	
	var _selector2 = document.querySelector('button[name=reload2]');
    _selector2.addEventListener('click', function (event) {
//var sldBody2 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdaten_20180104</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:PropertyIsLessThan><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:PropertyIsGreaterThan><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var sldBody2 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var layer2New = layer2.getSource();
	layer2New.updateParams({'SLD_BODY': sldBody2}); 
	map2.render();
        });
	
	var _selector3 = document.querySelector('button[name=reload3]');
    _selector3.addEventListener('click', function (event) {
//  var sldBody3 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdaten_20180104</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:PropertyIsLessThan><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:PropertyIsGreaterThan><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var sldBody3 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var layer3New = layer3.getSource();
	layer3New.updateParams({'SLD_BODY': sldBody3}); 
	map3.render();
        });
	
	var _selector4 = document.querySelector('button[name=reload4]');
    _selector4.addEventListener('click', function (event) {
 //   	var sldBody4 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdaten_20180104</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:PropertyIsLessThan><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:PropertyIsGreaterThan><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var sldBody4 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var layer4New = layer4.getSource();
	layer4New.updateParams({'SLD_BODY': sldBody4}); 
	map4.render();
        });
});

function updateMapTime(){


var gmtDate = new Date(startDate.valueOf() + startDate.getTimezoneOffset() * 60000);
	
	//2018-04-18 10:00:00
	var hours = gmtDate.getHours();
	if (hours < 10){hours = "0"+hours;}
var month = gmtDate.getMonth() + 1;
if (month < 10){month = "0"+month;}
var _date = gmtDate.getDate();
if (_date < 10){_date = "0"+_date;}

var datum = gmtDate.getFullYear()+"-"+ month+"-"+_date;
	var timestamp = datum + ' '+ hours+':00:00';
	console.log(timestamp)
	
/*	var hours = startDate.getHours();
	if (hours < 10){hours = "0"+hours;}
var month = startDate.getMonth() + 1;
if (month < 10){month = "0"+month;}
var _date = startDate.getDate();
if (_date < 10){_date = "0"+_date;}
var datum = startDate.getFullYear()+"-"+ month+"-"+_date;
	 timestamp = datum + ' '+ hours+':00:00';
	console.log(timestamp); */

var sldBody1 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>p1</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm10_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var layer1New = layer1.getSource();
	layer1New.updateParams({'SLD_BODY': sldBody1}); 
	map1.render();    

	var sldBody2 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>p2</ogc:PropertyName><ogc:Literal>'+ document.getElementById('pm25_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var layer2New = layer2.getSource();
	layer2New.updateParams({'SLD_BODY': sldBody2}); 
	map2.render();
	
		var sldBody3 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>temperature</ogc:PropertyName><ogc:Literal>'+ document.getElementById('temp_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var layer3New = layer3.getSource();
	layer3New.updateParams({'SLD_BODY': sldBody3}); 
	map3.render();

		var sldBody4 = '<?xml version="1.0" encoding="ISO-8859-1"?><StyledLayerDescriptor version="1.1.0"  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"  xmlns="http://www.opengis.net/sld"  xmlns:ogc="http://www.opengis.net/ogc"  xmlns:se="http://www.opengis.net/se"  xmlns:xlink="http://www.w3.org/1999/xlink"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><se:Name>opendem:luftdateninfo</se:Name><UserStyle><se:FeatureTypeStyle><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThan><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_1').value +'</ogc:Literal></ogc:PropertyIsLessThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#00FF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_2').value +'</ogc:Literal></ogc:PropertyIsLessThanOrEqualTo><ogc:PropertyIsGreaterThanOrEqualTo><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_1').value +'</ogc:Literal></ogc:PropertyIsGreaterThanOrEqualTo></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FFFF00</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule><se:Rule><ogc:Filter><ogc:And><ogc:PropertyIsEqualTo><ogc:PropertyName>timest</ogc:PropertyName><ogc:Literal>'+ timestamp +'</ogc:Literal></ogc:PropertyIsEqualTo><ogc:PropertyIsGreaterThan><ogc:PropertyName>humidity</ogc:PropertyName><ogc:Literal>'+ document.getElementById('humi_2').value +'</ogc:Literal></ogc:PropertyIsGreaterThan></ogc:And></ogc:Filter><se:PointSymbolizer><se:Graphic><se:Mark><se:WellKnownName>circle</se:WellKnownName><se:Fill><se:SvgParameter name="fill">#FF0000</se:SvgParameter></se:Fill></se:Mark><se:Size>15</se:Size></se:Graphic></se:PointSymbolizer></se:Rule></se:FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>';
	var layer4New = layer4.getSource();
	layer4New.updateParams({'SLD_BODY': sldBody4}); 
	map4.render();
	
    }


      function updateInfo() {
        var el = document.getElementById('info');
		//alert('info zupdate');
        //el.innerHTML = startDate.toISOString();
		// = 2018-04-21T03:04:00.652Z
		//el.innerHTML = startDate.toString();
		// Sat Apr 21 2018 05:04:00 GMT+0200 (Mitteleuropäische Sommerzeit)
		el.innerHTML = startDate;
      }

      function setTime() {
	  
	  if (iniDate == true){
	  iniDate = false;
	  
	   updateInfo();
	  } else {
        startDate.setHours(startDate.getHours() - 1);
		updateInfo();
		updateMapTime();
		}
      /*  if (startDate > Date.now()) {
          startDate = hoursAgo();
        } */
        //layers[1].getSource().updateParams({'TIME': startDate.toISOString()});
	
       
	  
      }
      setTime();

      var stop = function() {
        if (animationId !== null) {
          window.clearInterval(animationId);
          animationId = null;
        }
      };

      var play = function() {
        stop();
        animationId = window.setInterval(setTime, 1000 / frameRate);
      };

      var startButton = document.getElementById('play');
      startButton.addEventListener('click', play, false);

      var stopButton = document.getElementById('pause');
      stopButton.addEventListener('click', stop, false);
	  
	  	function helpMe(){

var helpDiv = document.getElementById("helpDiv");
       if(helpDiv.style.display == 'block'){
	   
          helpDiv.style.display = 'none';
	   } else {
	      helpDiv.style.display = 'block';}

var help = document.getElementById("help");
       if(help.style.border === "2px solid red"){
	   
	   help.style.border = "0px solid red"
         
	   } else {
	     help.style.border = "2px solid red"}
		  
		  
}

	  	function downloadMe(){

var downloadDiv = document.getElementById("downloadDiv");
       if(downloadDiv.style.display == 'block'){
	   
          downloadDiv.style.display = 'none';
	   } else {
	      downloadDiv.style.display = 'block';}

var download = document.getElementById("download");
       if(download.style.border === "2px solid red"){
	   
	   download.style.border = "0px solid red"
         
	   } else {
	     download.style.border = "2px solid red"}
		  
		  
}
	  
    </script>
  </body>
</html>